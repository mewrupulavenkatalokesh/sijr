<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Homemade Snacks — Pippalu & Murukulu</title>
  <meta name="description" content="Order fresh homemade Pippalu & Murukulu. Scan UPI or send order via WhatsApp." />
  <style>
    :root{--brand:#2f855a;--muted:#6b7280;--bg:#f8fafc}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,Arial;background:var(--bg);color:#111}
    header{background:var(--brand);color:#fff;padding:18px;text-align:center;font-weight:700}
    .wrap{max-width:980px;margin:18px auto;padding:0 16px}
    .grid{display:grid;gap:18px}
    @media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:#fff;border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(2,6,23,.06)}
    .card img{width:100%;height:220px;object-fit:cover;border-radius:8px}
    h2,h3{margin:8px 0;color:#234e2a}
    .price{font-weight:700}
    .muted{color:var(--muted)}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:700;border:2px solid var(--brand);background:var(--brand);color:#fff}
    .btn.alt{background:#fff;color:var(--brand)}
    /* Checkout */
    .checkout{display:grid;gap:18px;margin-top:18px}
    @media(min-width:900px){.checkout{grid-template-columns:1fr 360px}}
    .box{background:#fff;border-radius:12px;padding:16px;box-shadow:0 6px 20px rgba(2,6,23,.06)}
    label{display:block;margin:8px 0 6px;font-weight:600}
    input[type="text"], input[type="email"], input[type="tel"], textarea, select {
      width:100%;padding:12px;border-radius:10px;border:1px solid #e6e6e6;margin-bottom:8px
    }
    .row{display:flex;gap:8px}
    .row input{flex:1}
    .order-summary p{margin:8px 0}
    .total{font-size:18px;font-weight:800;margin-top:12px}
    .qr img{width:200px;max-width:100%}
    .notice{font-size:13px;color:var(--muted)}
    /* overlay modal */
    .overlay{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:999}
    .modal{background:#fff;border-radius:10px;padding:18px;min-width:280px;max-width:420px;box-shadow:0 10px 30px rgba(0,0,0,.3)}
    .modal.success{border-left:6px solid #16a34a}
    .modal.error{border-left:6px solid #dc2626}
    .modal h4{margin:0 0 8px}
    .modal p{margin:0 0 12px}
    .small{font-size:13px;color:#555}
  </style>
</head>
<body>
  <header>Homemade Snacks — Pippalu & Murukulu</header>

  <main class="wrap">
    <section class="grid">
      <article class="card">
        <img src="pippalu.jpg" alt="Pippalu">
        <h3>Pippalu</h3>
        <div class="price">₹150 / pack</div>
        <p class="muted">Crispy, spicy snack — perfect for tea time.</p>
        <div style="margin-top:10px;">
          Qty: <input id="qty-pippalu" type="number" min="0" value="0" style="width:80px;padding:8px;border-radius:8px;border:1px solid #ddd">
        </div>
      </article>

      <article class="card">
        <img src="murukulu.jpg" alt="Murukulu">
        <h3>Murukulu</h3>
        <div class="price">₹200 / pack</div>
        <p class="muted">Traditional crunchy Murukulu, small-batch.</p>
        <div style="margin-top:10px;">
          Qty: <input id="qty-murukulu" type="number" min="0" value="0" style="width:80px;padding:8px;border-radius:8px;border:1px solid #ddd">
        </div>
      </article>
    </section>

    <section class="checkout">
      <!-- left: form -->
      <div class="box">
        <h2>Checkout</h2>

        <form id="order-form" action="https://formspree.io/f/YOUR_FORM_ID" method="POST">
          <div class="order-summary">
            <p class="small">Items selected will appear below automatically.</p>
            <p id="items-list">Items: —</p>
            <p class="total">Total: ₹<span id="total-amt">0</span></p>
          </div>

          <label for="name">Full name</label>
          <input id="name" name="name" type="text" required placeholder="Your name">

          <label for="phone">Phone number</label>
          <input id="phone" name="phone" type="tel" required placeholder="10-digit mobile number">

          <label for="email">Email (optional)</label>
          <input id="email" name="email" type="email" placeholder="you@example.com">

          <label for="address">Address</label>
          <textarea id="address" name="address" rows="3" placeholder="Street, landmark, locality" required></textarea>

          <div class="row">
            <input id="pincode" name="pincode" type="text" placeholder="Pincode" required>
            <input id="city" name="city" type="text" placeholder="City" required>
          </div>

          <label for="payment">Payment method</label>
          <select id="payment" name="payment_method">
            <option value="UPI">UPI (Scan QR)</option>
            <option value="COD">Cash on Delivery</option>
          </select>

          <label for="note">Note (optional)</label>
          <input id="note" name="note" type="text" placeholder="Any message for delivery">

          <!-- hidden fields we send to Formspree too -->
          <input type="hidden" name="items" id="hidden-items">
          <input type="hidden" name="total" id="hidden-total">

          <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap">
            <button type="submit" class="btn">Place Order</button>
            <a id="btn-pay" class="btn alt" href="#payment-section">Scan & Pay</a>
          </div>
          <p class="notice" style="margin-top:12px">After payment by UPI, please share the screenshot to our WhatsApp using the button shown on success.</p>
        </form>
      </div>

      <!-- right: payment & QR -->
      <aside class="box" id="payment-section">
        <h2>Scan & Pay</h2>
        <div style="text-align:center" class="qr">
          <img src="upi-qr.png" alt="UPI QR">
          <p class="small">Scan with Google Pay / PhonePe / Paytm</p>
          <p style="margin-top:10px"><strong>UPI ID:</strong> <span id="upi-id">yourupi@bank</span></p>
        </div>

        <div style="margin-top:18px">
          <h3>Order contact</h3>
          <p class="muted">Phone: <a id="contact-phone" href="tel:+919999999999">+91 99999 99999</a></p>
          <p class="muted">WhatsApp will be used to confirm orders & payment proof.</p>
        </div>
      </aside>
    </section>
  </main>

  <!-- success/error modal -->
  <div id="overlay" class="overlay" role="dialog" aria-hidden="true">
    <div id="modal" class="modal">
      <h4 id="modal-title">Status</h4>
      <p id="modal-message"></p>
      <div style="margin-top:12px;text-align:right">
        <button id="modal-close" class="btn alt">Close</button>
      </div>
    </div>
  </div>

  <script>
    // ====== CONFIG - EDIT THESE ======
    const FORM_ENDPOINT = "https://formspree.io/f/xvgbdqpz"; // <-- replace with your Formspree endpoint
    const UPI_TEXT_ID = "yourupi@bank"; // change to your actual UPI ID
    const CONTACT_PHONE_RAW = "8790609258"; // change to your phone in international digits without '+'
    // =================================

    // product prices (INR)
    const PRICES = { pippalu: 150, murukulu: 200 };

    // UI elements
    const qtyP = document.getElementById('qty-pippalu');
    const qtyM = document.getElementById('qty-murukulu');
    const itemsList = document.getElementById('items-list');
    const totalEl = document.getElementById('total-amt');
    const hiddenItems = document.getElementById('hidden-items');
    const hiddenTotal = document.getElementById('hidden-total');
    const upiIdSpan = document.getElementById('upi-id');
    const contactPhoneAnchor = document.getElementById('contact-phone');

    upiIdSpan.textContent = UPI_TEXT_ID;
    contactPhoneAnchor.href = "tel:+" + CONTACT_PHONE_RAW;

    function updateOrderPreview(){
      const q1 = Math.max(0, parseInt(qtyP.value || 0));
      const q2 = Math.max(0, parseInt(qtyM.value || 0));
      let items = [];
      let total = 0;
      if(q1>0){ items.push(q1 + " × Pippalu (₹" + PRICES.pippalu + ")"); total += q1 * PRICES.pippalu; }
      if(q2>0){ items.push(q2 + " × Murukulu (₹" + PRICES.murukulu + ")"); total += q2 * PRICES.murukulu; }
      if(items.length === 0){ itemsList.textContent = "Items: —"; }
      else { itemsList.textContent = "Items: " + items.join(" • "); }
      totalEl.textContent = total;
      hiddenItems.value = items.join(" | ");
      hiddenTotal.value = total;
    }

    qtyP.addEventListener('input', updateOrderPreview);
    qtyM.addEventListener('input', updateOrderPreview);
    updateOrderPreview();

    // modal helpers
    const overlay = document.getElementById('overlay');
    const modalTitle = document.getElementById('modal-title');
    const modalMessage = document.getElementById('modal-message');
    const modalClose = document.getElementById('modal-close');
    function showModal(type, title, message){
      modalTitle.textContent = title;
      modalMessage.textContent = message;
      modalClose.textContent = "Close";
      const modalEl = document.getElementById('modal');
      modalEl.className = 'modal ' + (type === 'success' ? 'success':'error');
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden', 'false');
    }
    modalClose.addEventListener('click', ()=>{ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); });

    // Form submission (AJAX to Formspree)
    const form = document.getElementById('order-form');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      // validation: ensure at least one item
      if((parseInt(qtyP.value || 0) + parseInt(qtyM.value || 0)) === 0){
        showModal('error','No items selected','Please select at least one product (set quantity > 0).');
        return;
      }

      const formData = {
        name: form.name.value.trim(),
        phone: form.phone.value.trim(),
        email: form.email.value.trim(),
        address: form.address.value.trim(),
        pincode: form.pincode.value.trim(),
        city: form.city.value.trim(),
        items: hiddenItems.value,
        total: hiddenTotal.value,
        payment_method: form.payment_method.value,
        note: form.note.value.trim()
      };

      // basic required fields check
      if(!formData.name || !formData.phone || !formData.address || !formData.city || !formData.pincode){
        showModal('error','Missing information','Please fill all required fields (name, phone, address, city, pincode).');
        return;
      }

      // send to Formspree
      try{
        const res = await fetch(FORM_ENDPOINT, {
          method: "POST",
          headers: { 'Accept': 'application/json', 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
        if(res.ok){
          showModal('success','Order sent','Thank you! Your order has been sent. Tap "Share on WhatsApp" to send payment proof.');
          // create WhatsApp share URL with order summary
          const waMessage = encodeURIComponent(
            `Hello, I placed an order:\n${formData.items}\nTotal: ₹${formData.total}\nName: ${formData.name}\nPhone: ${formData.phone}\nAddress: ${formData.address}, ${formData.city} - ${formData.pincode}\nPayment: ${formData.payment_method}`
          );
          // open WhatsApp share in a new tab when user clicks modal (or offer a link)
          // We'll create a button in modal for user convenience:
          modalMessage.innerHTML += "<br/><br/><a id='whalink' class='btn' href='https://wa.me/" + CONTACT_PHONE_RAW + "?text=" + waMessage + "' target='_blank'>Share on WhatsApp</a>";
          // reset quantities and form (optional)
          qtyP.value = 0; qtyM.value = 0; updateOrderPreview();
          form.reset();
        } else {
          const text = await res.text();
          console.error('Formspree error', res.status, text);
          showModal('error','Failed to send order','Server rejected the request. Please try again or contact us on WhatsApp.');
        }
      } catch(err){
        console.error('Network error', err);
        showModal('error','Failed to send order','Network error. Please check your internet and try again.');
      }
    });
  </script>
</body>
</html>
